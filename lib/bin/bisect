#!/usr/bin/env python3

from math import floor
from pathlib import Path
import sys
import typing as T


path = Path(sys.argv[1])
recipe: T.List[str]
if len(sys.argv) == 3:
    recipe = list(sys.argv[2])
else:
    recipe = []

with open(path) as f:
    lines = f.readlines()

Depth = len(recipe) + 1
N = len(lines)
n = floor(N / (2 ** Depth))

offset = 0
for depth, x in enumerate(recipe, start=1):
    if x == 'g':
        offset += floor(N / (2 ** depth)) + 1
    elif x != 'b':
        raise RuntimeError('bad recipe')
del depth, x
print(f'offset={offset} depth={Depth} N={N} n={n}')
